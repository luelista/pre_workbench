
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../getting-started/">
      
      
        <link rel="next" href="../code-generation/">
      
      <link rel="icon" href="../images/appicon.ico">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.11">
    
    
      
        <title>Syntax Reference - PRE Workbench</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.0d440cfe.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.2505c338.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="purple" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#grammar-files" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="PRE Workbench" class="md-header__button md-logo" aria-label="PRE Workbench" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            PRE Workbench
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Syntax Reference
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/luelista/pre_workbench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="PRE Workbench" class="md-nav__button md-logo" aria-label="PRE Workbench" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    PRE Workbench
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/luelista/pre_workbench" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../getting-started/" class="md-nav__link">
        Getting Started
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Syntax Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Syntax Reference
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#grammar-files" class="md-nav__link">
    Grammar Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-examples" class="md-nav__link">
    Further Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-definitions" class="md-nav__link">
    Type Definitions
  </a>
  
    <nav class="md-nav" aria-label="Type Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named" class="md-nav__link">
    named
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#struct" class="md-nav__link">
    struct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repeat" class="md-nav__link">
    repeat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variant" class="md-nav__link">
    variant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch" class="md-nav__link">
    switch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits" class="md-nav__link">
    bits
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expressions" class="md-nav__link">
    Expressions
  </a>
  
    <nav class="md-nav" aria-label="Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-functions" class="md-nav__link">
    Built-in functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../code-generation/" class="md-nav__link">
        Code Generation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../key-bindings/" class="md-nav__link">
        Key Bindings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../extending/" class="md-nav__link">
        Extending
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#grammar-files" class="md-nav__link">
    Grammar Files
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    Example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    Parameters
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#further-examples" class="md-nav__link">
    Further Examples
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#type-definitions" class="md-nav__link">
    Type Definitions
  </a>
  
    <nav class="md-nav" aria-label="Type Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#named" class="md-nav__link">
    named
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#struct" class="md-nav__link">
    struct
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#repeat" class="md-nav__link">
    repeat
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#variant" class="md-nav__link">
    variant
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switch" class="md-nav__link">
    switch
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#union" class="md-nav__link">
    union
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#bits" class="md-nav__link">
    bits
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#expressions" class="md-nav__link">
    Expressions
  </a>
  
    <nav class="md-nav" aria-label="Expressions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#built-in-functions" class="md-nav__link">
    Built-in functions
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/luelista/pre_workbench/edit/main/docs/syntax-reference.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4v-2m10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1 2.1 2.1Z"/></svg>
    </a>
  
  



  <h1>Syntax Reference</h1>

<h2 id="grammar-files">Grammar Files</h2>
<p>A grammar file consists of a map of names to type definitions, in the format <code>name1 definition1 name2 definition2 ...</code>, each element separated by white-space. The following sections explain all available base types from which the type definitions can be assembled.</p>
<pre><code>grammar_file: field*
field: IDENTIFIER type
type: named | struct | repeat | variant | switch | union | bits

params: (&quot;(&quot; [parampair (&quot;,&quot; parampair)*] &quot;)&quot;)?
parampair: IDENTIFIER &quot;=&quot; value
</code></pre>
<h2 id="example">Example</h2>
<p>The following grammar definition defines a simple protocol, with a magic number in the beginning of the packet,
followed by repeated TLV (type-length-value) items.</p>
<pre><code>
MyProto struct (endianness=&quot;&gt;&quot;){
    magic UINT32(magic=2864434397, color=&quot;#aa0000&quot;)
    tlvs repeat MyTLV
}

MyTLV struct {
    header struct {
        type UINT16(color=&quot;#aaaa00&quot;)
        length UINT16(color=&quot;#00aa00&quot;)
    }
    payload BYTES[header.length](color=&quot;#0000aa&quot;)
}
</code></pre>
<p>Parsing the following example data, consisting of the magic number and two TLV items, with MyProto from above grammar, gives us the results shown in the screenshot below:</p>
<pre><code>00000000: AA BB CC DD 00 DD 00 04  41 41 41 41 00 EE 00 10  ........AAAA....
00000010: 00 11 22 33 44 55 66 77  88 99 AA BB CC DD EE FF  ..&quot;3DUfw........
</code></pre>
<p><img alt="Parser Result" src="../images/example-parse-result.png" /></p>
<h2 id="parameters">Parameters</h2>
<p>Some parameters are recognized on all types, where the <code>params</code> element is accepted. Other parameters are recognized on 
specific types only, but can also be declared on any surrounding container type, causing them to cascade to the children
(e.g., declaring <code>endianness</code> on a struct specifies the endianness for all struct elements). </p>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>ignore_errors</td>
<td>Boolean</td>
<td>If true, all errors which may occur during parsing this element or it's children are ignored.</td>
</tr>
<tr>
<td>reassemble_into</td>
<td>list (Expression or string)</td>
<td></td>
</tr>
<tr>
<td>store_into</td>
<td>list (Expression or string)</td>
<td></td>
</tr>
<tr>
<td>segment_meta</td>
<td></td>
<td>experimental???</td>
</tr>
<tr>
<td>hide</td>
<td></td>
<td>If specified, this field is hidden from the Grammar Parse Result tree view</td>
</tr>
</tbody>
</table>
<h2 id="further-examples">Further Examples</h2>
<p>For further examples, have a look at the test cases for the <a href="https://github.com/luelista/pre_workbench/blob/master/tests/test_grammar_parser.py">parser</a> 
and <a href="https://github.com/luelista/pre_workbench/blob/master/tests/test_grammar_code_syntax.py">syntax</a>.</p>
<h2 id="type-definitions">Type Definitions</h2>
<h3 id="named">named</h3>
<pre><code>named: IDENTIFIER params
</code></pre>
<p>In any place where a type is expected, a name can be used to reference another type defined in the same file. Many common types of integers, strings, floating-point numbers and network addresses are predefined. For easier adaption, they have the same name as in Wireshark dissectors.</p>
<p>This allows for generalization, because the same type can be references in multiple places (e.g. to define a common header shared by many different packet types). It also can make the grammar easier to read, because special cases can be put away at the end of the file, and the nesting depth can be reduced.
After the type name, parameters configuring parsing or visualization details can be provided in parentheses. This makes it possible to define more generic types, where e.g. the endianness is left open until the usage.</p>
<pre><code>UINT32(endianness=&quot;&lt;&quot;)
--&gt; unsigned integer, 4 byte, little endian.

IPv4
--&gt; IP version 4 address, in binary, in network byte order.

STRING[32](charset=&quot;utf-8&quot;)
--&gt; character string in UTF-8 encoding, 32 bytes long

UINT_STRING(size_len=2, endianness=&quot;&gt;&quot;, charset=&quot;utf-8&quot;)
--&gt; character string in UTF-8 encoding, with an unsigned integer, 2 byte, big endian prefix specifing the string length.

mytype
--&gt; custom type declared elsewhere
</code></pre>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>endianness</td>
<td>String</td>
<td>"&lt;" (Little endian) or "&gt;" (Big endian). <strong>Required</strong> by some built-in named types (multibyte int and floats).</td>
</tr>
<tr>
<td>charset</td>
<td>String</td>
<td><a href="https://docs.python.org/3/library/codecs.html#standard-encodings">Python charsets, e.g. "utf-8"</a>. <strong>Required</strong> by all string types.</td>
</tr>
<tr>
<td>unit</td>
<td>String</td>
<td>"s", "ms", "us". Optional for ABSOLUTE_TIME, guessed if absent.</td>
</tr>
<tr>
<td>magic</td>
<td>???</td>
<td>If specified, the field is only valid if its value matches the magic.</td>
</tr>
<tr>
<td>size</td>
<td>int expression</td>
<td>Optional for STRING and BYTES fields, the rest of the parsing unit is matched if absent. Short syntax: STRING[expr]</td>
</tr>
<tr>
<td>size_len</td>
<td>int expression</td>
<td><strong>Required</strong> for UINT_STRING and UINT_BYTES</td>
</tr>
<tr>
<td>parse_with</td>
<td>named</td>
<td>Usually used on BYTES or UINT_BYTES fields, causes the value to be parsed as a child parsing unit. This allows to run the child parser with a fixed length, by specifying <code>size</code> or using UINT_BYTES.</td>
</tr>
</tbody>
</table>
<h3 id="struct">struct</h3>
<p>A struct is defined as an ordered list of named field definitions, where each field has a type.</p>
<pre><code>struct: &quot;struct&quot; params &quot;{&quot; (IDENTIFIER type)* &quot;}&quot;
</code></pre>
<pre><code>pascal_string struct {
    length UINT16(endianness=&quot;&gt;&quot;)
    value STRING[length](charset=&quot;utf8&quot;)
}
# note: a pascal_string could be defined more easily using the UINT_STRING built-in, as shown above
</code></pre>
<p>If the name of a struct field starts with an underscore, it's contents will be collapsed in the tree view by default.</p>
<h3 id="repeat">repeat</h3>
<pre><code>repeat: &quot;repeat&quot; params type
</code></pre>
<pre><code>int32_array struct(endianness=&quot;&gt;&quot;) {
    count UINT16
    items repeat(times=(count)) INT32
}
</code></pre>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>times</td>
<td>int expression</td>
<td></td>
</tr>
<tr>
<td>until</td>
<td>int expression</td>
<td></td>
</tr>
<tr>
<td>until_invalid</td>
<td>boolean</td>
<td></td>
</tr>
</tbody>
</table>
<h3 id="variant">variant</h3>
<pre><code>variant: &quot;variant&quot; params &quot;{&quot; type* &quot;}&quot;
</code></pre>
<pre><code>capture_file variant {
    pcapng_file(endianness=&quot;&gt;&quot;)
    pcapng_file(endianness=&quot;&lt;&quot;)
    pcap_file(endianness=&quot;&gt;&quot;)
    pcap_file(endianness=&quot;&lt;&quot;)
}

</code></pre>
<h3 id="switch">switch</h3>
<pre><code>switch: &quot;switch&quot; expression params &quot;{&quot; (&quot;case&quot; expression &quot;:&quot; type)* &quot;}&quot;
</code></pre>
<pre><code>my_packet struct {
    header struct {
        type UINT8
    }
    payload switch (header.type) {
        case (1): payload_1
        case (2): payload_2
    }
}
</code></pre>
<h3 id="union">union</h3>
<pre><code>union: &quot;union&quot; params &quot;{&quot; (IDENTIFIER type)* &quot;}&quot;
</code></pre>
<pre><code>u_s union {
    unsigned UINT16
    signed INT16
}
</code></pre>
<h3 id="bits">bits</h3>
<pre><code>bits: &quot;bits&quot; params &quot;{&quot; (IDENTIFIER &quot;:&quot; number)* &quot;}&quot;
</code></pre>
<pre><code>header bits(endianness=&quot;&lt;&quot;) {
    TRX : 15
    res_1 : 1
    MID : 10
    res_2 : 2
    A : 1
    SEQ_hi : 3
    LEN : 15
    SEQ_lo : 8
    GROUP : 6
    res_3 : 3
}
</code></pre>
<table>
<thead>
<tr>
<th>parameter</th>
<th>type</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>endianness</td>
<td>String</td>
<td>"&lt;" (Little endian) or "&gt;" (Big endian).</td>
</tr>
</tbody>
</table>
<h2 id="expressions">Expressions</h2>
<p>TODO: describe expression syntax </p>
<h3 id="built-in-functions">Built-in functions</h3>
<p>Currently, all functions have exactly one parameter.</p>
<table>
<thead>
<tr>
<th>name</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td>hex</td>
<td>Returns a hex string representation of the parameter.</td>
</tr>
<tr>
<td>dec</td>
<td>Returns a decimal string representation of the parameter.</td>
</tr>
<tr>
<td>dotted_quad</td>
<td>Returns a dot-separated decimal representation of the bytes passed as a parameter, like in an IPv4 address.</td>
</tr>
<tr>
<td>ip6</td>
<td>Returns a colon-separated hexadecimal representation, like in an IPv6 or Ethernet address.</td>
</tr>
<tr>
<td>dec</td>
<td>Returns a decimal string representation of the parameter.</td>
</tr>
<tr>
<td>len</td>
<td>Returns the length of the parameter.</td>
</tr>
<tr>
<td>snip</td>
<td>Truncates the parameter to 32 bytes, if longer.</td>
</tr>
<tr>
<td>pad</td>
<td>Returns the number of bytes required to pad the current buffer to a multiple of N bytes.</td>
</tr>
</tbody>
</table>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2020 - 2023 Mira Weller
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/luelista/pre_workbench" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
    
    
    
      
      
    
    <a href="https://chaos.social/@luelistan" target="_blank" rel="noopener me" title="chaos.social" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.2.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M433 179.11c0-97.2-63.71-125.7-63.71-125.7-62.52-28.7-228.56-28.4-290.48 0 0 0-63.72 28.5-63.72 125.7 0 115.7-6.6 259.4 105.63 289.1 40.51 10.7 75.32 13 103.33 11.4 50.81-2.8 79.32-18.1 79.32-18.1l-1.7-36.9s-36.31 11.4-77.12 10.1c-40.41-1.4-83-4.4-89.63-54a102.54 102.54 0 0 1-.9-13.9c85.63 20.9 158.65 9.1 178.75 6.7 56.12-6.7 105-41.3 111.23-72.9 9.8-49.8 9-121.5 9-121.5zm-75.12 125.2h-46.63v-114.2c0-49.7-64-51.6-64 6.9v62.5h-46.33V197c0-58.5-64-56.6-64-6.9v114.2H90.19c0-122.1-5.2-147.9 18.41-175 25.9-28.9 79.82-30.8 103.83 6.1l11.6 19.5 11.6-19.5c24.11-37.1 78.12-34.8 103.83-6.1 23.71 27.3 18.4 53 18.4 175z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit"], "search": "../assets/javascripts/workers/search.db81ec45.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.6df46069.min.js"></script>
      
    
  </body>
</html>